$(document).ready(function () {


    $(".solutions__slide > span").each(function (index, item) {
        let newIndex = parseInt(index + 1)
        $(this).text("0" + newIndex)
    })


    function cuteText(textLimit, finalLength) {
        $(".solutions__slide>p").each(function () {
            if ($(this).text().length > textLimit) {
                $(this).html($(this).text().slice(0, finalLength) + "...")
            }
        })
    }

    if ($(window).width() > 1025) {
        cuteText(365, 365)
    }

    $(document).ready(function () {
        for (var i = 0; i < $('.someclass').length; i++) {
            $($('.someclass')[i]).find('.class').text(i + 1);
            console.log($('.someclass')[i]);
        }
    });
    var lastScrollTop = 0;

    function closePreloader() {
        $(".preloader").addClass("close")
        $("body").removeClass("preloader-active")
        if (typeof acrode !== "undefined") {
            // acrode Cookie Notice plugin
			if (document.readyState === 'complete') {
				window.acrode.initCookieNotification()
			} else {
				window.addEventListener("load", () => {
					window.acrode.initCookieNotification()
				});
			}
            $(".ac-cookie-settings").on("click", function(e) {
                e.preventDefault();
                window.acrode.showCookieNotification(); // show acrode Cookie Notice plugin
            })
        }
    }

    function animFirstScreen() {
        $(".header").addClass("fade-opacity-on")
        $(".intro__info").addClass("fade-on")
        $(".intro__hand").addClass("fade-right-on")
        $(".intro__img").addClass("fade-opacity-on")
        $(".intro__circle").addClass("fade-opacity-on")
        $(".intro__bubble").addClass("fade-opacity-on")
        $(".intro__bubble-scale").addClass("scalePlus")
    }

    // start closing preloader
    closePreloader()
    animFirstScreen()

    $(window).scroll(function () {
        let block = $(".calculate").offset().top - 300;
        let calculateHeight = $(".calculate").innerHeight() / 10
        let block2 = $(".solutions").offset().top + calculateHeight
        var scroll = $(window).scrollTop();
        if (scroll >= block2) {

            $(".calculate").addClass("calculate-anim")
            setTimeout(function () {

                $(".calculate").addClass("calculate-radius")
            }, 250)
        } else {
            $(".calculate").removeClass("calculate-anim")
            setTimeout(function () {
                $(".calculate").removeClass("calculate-radius")
            }, 250)
        }

    });

    setInterval(function () {
        $(".intro__center svg").addClass("anim")
        setTimeout(function () {
            $(".intro__center svg").removeClass("anim")

        }, 2000)
    }, 5000)

    $(".intro__circle ").on("click", function () {
        $('html,body').animate({
            scrollTop: $(".partners").offset().top
        }, 1000);
    })


    var isScrolling = false;


    if ($('body').hasClass('main')) {
        window.addEventListener("scroll", throttleScroll, false);
        throttleScroll();
    }

    function throttleScroll(e) {
        if (isScrolling == false) {
            window.requestAnimationFrame(function () {
                scrolling(e);
                isScrolling = false;
            });
        }
        isScrolling = true;
    }

    let fadeArr = document.querySelectorAll('.faded');
    let fadeBounceArr = document.querySelectorAll('.fade');
    let fadedArr = document.querySelectorAll('.fade-small');
    let animPart = document.querySelectorAll('.anim-part');


    function scrolling(e) {
        // fade
        for (var i = 0; i < fadeArr.length; i++) {
            var fadeItem = fadeArr[i];
            if (isPartiallyVisible(fadeItem)) {
                fadeItem.classList.add("faded-on");
            } else {

            }
        }
        for (var i = 0; i < fadeBounceArr.length; i++) {
            var fadeItem = fadeBounceArr[i];
            if (isPartiallyVisible(fadeItem)) {
                fadeItem.classList.add("fade-on");
            } else {

            }
        }
        for (var i = 0; i < fadedArr.length; i++) {
            var fadeItem = fadedArr[i];
            if (isPartiallyVisible(fadeItem)) {
                fadeItem.classList.add("fade-small-on");
            } else {

            }
        }
        for (var i = 0; i < animPart.length; i++) {
            var fadeItem = animPart[i];
            if (isPartiallyVisible(fadeItem)) {
                fadeItem.classList.add("anim-part-on");
            } else {

            }
        }

    }

    function isPartiallyVisible(el) {
        var elementBoundary = el.getBoundingClientRect();

        var top = elementBoundary.top;
        var bottom = elementBoundary.bottom;
        var height = elementBoundary.height;
        if ($(window).width() > 1024) {
            return ((top + height >= 0) && (height + window.innerHeight >= bottom + 100))
        } else {
            return ((top + height >= 0) && (height + window.innerHeight >= bottom))

        }
    }

    function isFullyVisible(el) {
        var elementBoundary = el.getBoundingClientRect();

        var top = elementBoundary.top;
        var bottom = elementBoundary.bottom;

        return ((top >= 0) && (bottom <= window.innerHeight));
    }


    var $ripple = $('.js-ripple');

    $ripple.on('click.ui.ripple', function (e) {

        var $this = $(this);
        var $offset = $this.parent().offset();
        var $circle = $this.find('.c-ripple__circle');

        var x = e.pageX - $offset.left;
        var y = e.pageY - $offset.top;

        $circle.css({
            top: y + 'px',
            left: x + 'px'
        });

        $this.addClass('is-active');

    });

    $ripple.on('animationend webkitAnimationEnd oanimationend MSAnimationEnd', function (e) {
        $(this).removeClass('is-active');
    });

})

$(document).ready(function () {


    function isiPhone() {
        return (
            (navigator.platform.indexOf("iPhone") != -1) ||
            (navigator.platform.indexOf("iPod") != -1)
        );
    }

    if (isiPhone()) {
        $(".experience").addClass("iphone")
    }


    $(".header__nav a[href='#open-popup']").on("click", function (e) {
        $(".popup-contactNew").addClass("open");
        $("body").addClass("no-scroll")
        e.preventDefault()
    })
    $(".menu__nav a:last-child").on("click", function (e) {
        $(".popup-contactNew").addClass("open")
        $("body").addClass("no-scroll")
        e.preventDefault()
    })
    // cookie

    $(".close-cookie").on("click", function (e) {
        e.preventDefault()
        $(".cookie").addClass("hidden")
        localStorage.setItem('cookie', 'show')
    })

    if (localStorage.getItem('cookie') == 'show') {
        $(".cookie").fadeOut();
    }

//swiper


    if ($("body").hasClass("main")) {


        var swiperSlider = new Swiper('.solutions__slider', {
            pagination: '.swiper-pagination',
            slidesPerView: 'auto',
            centeredSlides: true,
            loop: true,
            speed: 800,
            spaceBetween: 60,
            on: {

                slideChangeTransitionStart: function () {
                    if ($(window).innerWidth() > 601) {
                        $('.solutions__slider .swiper-slide-active').siblings().find('p').slideUp();
                        $('.solutions__slider .swiper-slide-active').siblings().removeClass("anim")
                        $('.solutions__slider .swiper-slide-active , .swiper-slide-duplicate-active ').find('p').slideDown();
                        $('.solutions__slider .swiper-slide-active , .swiper-slide-duplicate-active ').addClass('anim');

                    }
                },
            },
            navigation: {
                nextEl: '.solutions__nav-right',
                prevEl: '.solutions__nav-left',
            },
            resistanceRatio: '0',
            breakpoints: {
                // when window width is >= 320px
                320: {
                    allowTouchMove: true
                },
                1025: {
                    allowTouchMove: false,
                    autoHeight: true
                }
            }
        });

        var swiperSlider = new Swiper('.solutions__slider', {
            pagination: '.swiper-pagination',
            slidesPerView: 'auto',
            centeredSlides: true,
            loop: true,
            speed: 800,
            spaceBetween: 60,
            on: {

                slideChangeTransitionStart: function () {
                    if ($(window).innerWidth() > 601) {
                        $('.solutions__slider .swiper-slide-active').siblings().find('p').slideUp();
                        $('.solutions__slider .swiper-slide-active').siblings().removeClass("anim")
                        $('.solutions__slider .swiper-slide-active , .swiper-slide-duplicate-active ').find('p').slideDown();
                        $('.solutions__slider .swiper-slide-active , .swiper-slide-duplicate-active ').addClass('anim');

                    }
                },
            },
            navigation: {
                nextEl: '.solutions__nav-right',
                prevEl: '.solutions__nav-left',
            },
            resistanceRatio: '0',
            breakpoints: {
                // when window width is >= 320px
                320: {
                    allowTouchMove: true
                },
                1025: {
                    allowTouchMove: false
                }
            }
        });
        var partnersSlider = new Swiper('.partners__list', {
            slidesPerView: 5,
            spaceBetween: 15,

            mode: "vertical",
            autoplay: {
                delay: 5000,

            },
            virtualTranslate: false,
            loop: true,
            autoplayStopOnLast: false,
            speed: 350,
            allowTouchMove: false,
            pagination: {
                el: '.partners__dots',
                renderCustom: function (swiper, current, total) {
                    return "<span>" + current + ' of ' + total + "</span>";
                },
                clickable: true
            },
            breakpoints: {
                // when window width is >= 320px
                320: {
                    slidesPerView: 2,
                },
                621: {
                    slidesPerView: 4,
                },
                1025: {
                    slidesPerView: 5,
                    allowTouchMove: false
                }
            },
        });
        if ($(".partners__item").length <= 5) {
            $(".partners__wrap").addClass("center")
        }

        partnersSlider.on("slideChangeTransitionStart", function () {
            $('.partners__list .swiper-slide').addClass('opacidown');
            $('.partners__wrap').addClass('opacidown1');

            setTimeout(function () {
                $('.partners__list .swiper-slide').removeClass('opacidown');
                $('.partners__wrap').removeClass('opacidown1');

            }, 700);
        })


        if ($(window).width() < 1024) {
            jQuery('.partners__wrap').swipe({
                swipeStatus: function (event, phase, direction, distance, duration, fingerCount, fingerData, currentDirection) {
                    if (phase == "end") {
                        //сработает через 20 пикселей то число которое выбрали в threshold
                        if (direction == 'left') {
                            partnersSlider.slideNext();
                        }
                        if (direction == 'right') {
                            partnersSlider.slidePrev();

                            //сработает при движении вправо
                        }
                        if (direction == 'up') {
                            //сработает при движении вверх
                        }
                        if (direction == 'down') {
                            //сработает при движении вниз
                        }
                    }
                },
            });
        }

        $(".calculate__item:first-child .calculate__radio").on("click", function () {
            $(".calculate__item:first-child .calculate__radio").removeClass("active");
            $(this).addClass("active")
            calculate()
        })
        $(".calculate__item:last-child .calculate__radio").on("click", function () {
            $(".calculate__item:last-child .calculate__radio").removeClass("active");
            $(this).addClass("active");
            if ($(this).index() == 0) {
                slider.noUiSlider.updateOptions({
                    range: {
                        min: 1000,
                        max: 25000
                    }
                }, false);
            } else if ($(this).index() == 1) {
                slider.noUiSlider.updateOptions({
                    range: {
                        min: 5000,
                        max: 100000
                    }
                }, false);
            } else {
                slider.noUiSlider.updateOptions({
                    range: {
                        min: 25000,
                        max: 1000000
                    }
                }, false);
            }

            calculate2()
        })

        var slider = document.getElementById('calculate__range');
        var slider1 = document.getElementById('calculate__range1');
        var calc = document.getElementById('calc');
        var calc2 = document.getElementById('calc2');
        let calcValue2 = 0
        let calcValue1 = 0
        // noui calculator
        noUiSlider.create(slider, {
            start: 0,
            connect: "lower",
            range: {
                'min': 1000,
                'max': 5000
            },
            format: {
                from: function (value) {
                    return parseInt(value);
                },
                to: function (value) {
                    return parseInt(value);
                }
            }
        });
        noUiSlider.create(slider1, {
            start: 0,
            connect: "lower",
            range: {
                'min': 1,
                'max': 20
            },
            format: {
                from: function (value) {
                    return parseInt(value);
                },
                to: function (value) {
                    return parseInt(value);
                }
            }
        });

        calc.innerHTML = slider.noUiSlider.options.range.min
        calc2.innerHTML = slider1.noUiSlider.options.range.max

        slider.noUiSlider.on('update', function (values, handle) {
            calcValue2 = values[handle];
            calc2.innerHTML = values[handle] + " €";

            calculate2()

        });
        slider1.noUiSlider.on('update', function (values, handle) {
            calcValue1 = values[handle];
            calc.innerHTML = values[handle];

            calculate()
        });

        function calculate() {
            $(".calculate__item:first-child .calculate__bottom span").text(Math.ceil(calcValue1 * $(".calculate__item:first-child .calculate__radio.active input").val() * .1))
        }

        function calculate2() {
            $(".calculate__item:last-child .calculate__bottom span").text(Math.ceil(calcValue2 * .25))
        }
    }
    // anchor
    calculate2()
    $(".header__nav a[href='#product']").click(function (e) {
        e.preventDefault();
        var aid = $(this).attr("href");
        $('html,body').animate({scrollTop: $(aid).offset().top - 70}, 'slow');
    });


    $(".menu-acnchor").click(function (e) {
        e.preventDefault();
        var aid = $(this).attr("href");
        $('html,body').animate({scrollTop: $(aid).offset().top - 70}, 'slow');
        $(".menu").removeClass("open")
        $(".header").removeClass("open")
        $("body").removeClass("no-scroll")
    });

    // year copyright
    $(".year").text((new Date).getFullYear());

    let text = $(".customizable__color:first-child").text()


    // header

    $(window).scroll(function () {
        var header = $('.header');
        var scroll = $(window).scrollTop();
        if (!$(".header").hasClass("open")) {

            if (scroll >= 10) header.addClass('fixed')
            else header.removeClass('fixed');
        } else
            header.removeClass('fixed');
    });
    $(".burger").on("click", function () {
        $(this).toggleClass("open")
        $(".menu").toggleClass("open")
        $(".header").toggleClass("open")
        $("body").toggleClass("no-scroll")
    })

    // tabs

    function resetTabs() {
        $(".customizable").css("background", "rgb(9, 95, 236)");
        $(".integrations").css("background", "rgb(9, 95, 236)");
        $(".calculate .container").css("background", "rgb(9, 95, 236)");


        $(".customizable__color.active").text(text)
        $(".customizable__color").removeClass("active");
        $(".customizable__tabs div").removeClass("active")
        $(".customizable__item").removeClass("active")
        $(".customizable__tabs div:first-child").addClass("active")
        $(".customizable__item:first-child").addClass("active")
        $(".line-nav").css("margin-left", 0)
        $(".upper-line").css("margin-left", 0)

        $(".customizable__item:nth-child(1) .customizable__photo img").removeClass("open")
        $(".small-cart img").removeClass("small")
        $(".customizable__item:nth-child(1) .customizable__photo > img:nth-child(1)").addClass("open")
        $(".small-cart img:nth-child(1)").addClass("small")
    }

    $(".customizable__tabs div").on("click", function () {
        var currentTab = $(this);
        let index = currentTab.data("background");

        $(".customizable__color").removeClass("active")
        $(".customizable__item").removeClass("active").eq($(this).index()).addClass("active");
        $(".customizable").css("background", index).find(".customizable__tabs div").removeClass("active").eq($(this).index()).addClass("active")
        $(".calculate .container").css("background", index)
        $(".integrations ").css("background", index)
        $(".customizable__item:nth-child(1) .customizable__photo img").removeClass("open")
        $(".small-cart img").removeClass("small")
        $(".customizable__item:nth-child(1) .customizable__photo > img:nth-child(1)").addClass("open")
        $(".small-cart img:nth-child(1)").addClass("small")


        $(".line-nav , .upper-line").css("opacity", 1)


        if (currentTab.index() == 0) {
            $(".line-nav").css("margin-left", 0)
            $(".upper-line").css("margin-left", 0)
        }
        if (currentTab.index() == 1) {
            $(".line-nav").css("margin-left", currentTab.innerWidth());
            $(".upper-line").css("margin-left", currentTab.innerWidth());
        }
        if (currentTab.index() == 2) {
            $(".line-nav").css("margin-left", currentTab.innerWidth() * 2);
            $(".upper-line").css("margin-left", currentTab.innerWidth() * 2);

        }
    })

    $(".customizable__color").on("click", function () {
        let currentTab = $(this);
        let currentTabIndex = $(this).index() + 1;
        let currentTabIndexFixed = $(this).index() + 2;
        let currentColor = currentTab.data("background");
        $(".customizable__color").removeClass("active")
        currentTab.css("background", currentColor).addClass("active");


        $(".customizable").css("background", currentColor, "opacity", 1);
        $(".integrations ").css("background", currentColor)
        $(".calculate .container").css("background", currentColor)


        if (currentTab.hasClass("active")) {
            $(".customizable__color").text($('.custBtn').attr('data-press'));
            currentTab.text($('.custBtn').attr('data-pressed'));
        }

        $(".customizable__item:nth-child(1) .customizable__photo img").removeClass("open")
        $(".small-cart img").removeClass("small")
        $(".customizable__item:nth-child(1) .customizable__photo > img:nth-child(" + currentTabIndexFixed + ")").addClass("open")
        $(".small-cart img:nth-child(" + currentTabIndexFixed + ")").addClass("small")
    })

    $(window).scroll(function () {
        let st = $(this).scrollTop();
        if (st < $(".calculate").offset().top + 200) {
            resetTabs()
        } else if (st > $(".integrations").offset().top) {
            resetTabs()
        }

    })

    if ($(window).innerWidth() < 625) {
        $(".customizable__circle").removeClass("active")
        $(".svg-click").removeClass("active")
        $(".lenz").addClass("active")
        $(".customizable__circle:nth-child(3)").addClass("active")
        $(".customizable__circle:nth-child(3) .checkmark").addClass("active")
    }

    // svg change logo
    $(".customizable__circle").on("click", function () {

        $(".customizable__circle").find(".checkmark").removeClass("active")
        $(".customizable__circle").removeClass("active")
        $(this).find(".checkmark").addClass("active")
        $(this).addClass("active")
    })
    $(".customizable__circle--one").on("click", function () {
        $('.svg-click').removeClass("active")
        $(".optivision").addClass("active")
    })
    $(".customizable__circle--second").on("click", function () {
        $('.svg-click').removeClass("active")
        $(".glaslandia").addClass("active")
    })
    $(".customizable__circle--three").on("click", function () {
        $('.svg-click').removeClass("active")
        $(".lenz").addClass("active")
    })
    $(".customizable__circle--four").on("click", function () {
        $('.svg-click').removeClass("active")
        $(".optican").addClass("active")
    })

    // popup

    $(".started__circle a").on("click", function (e) {
        e.preventDefault()
    })
    $(".popup__close svg").on("click", function (e) {
        e.stopPropagation()
        e.preventDefault()
        $('.popup').removeClass("open")
        $(".menu").removeClass("open")
        $("body").removeClass("no-scroll")
        $(".header , .burger").removeClass("open")
    })

    // cookie

    // experience

    var media = $('#video').not("[autoplay='autoplay']");
    var tolerancePixel = 40;

    function checkMedia() {
        // Get current browser top and bottom
        var scrollTop = $(window).scrollTop() + tolerancePixel;
        var scrollBottom = $(window).scrollTop() + $(window).height() - tolerancePixel;

        media.each(function (index, el) {
            var yTopMedia = $(this).offset().top;
            var yBottomMedia = $(this).height() + yTopMedia;

            if (scrollTop < yBottomMedia && scrollBottom > yTopMedia) { //view explaination in `In brief` section above
                $(this).get(0).play();
            } else {
                $(this).get(0).pause();
            }
        });

        //}
    }

    $(document).on('scroll', checkMedia);


})


$(document).ready(function () {

    let slideNow = 1;
    let slideCount = $('.feature__slides').children().length;
    let slideWidth = 0;
    let clicked = true;
    let featureItemWidth = $(".feature__inner a").innerHeight();
    let featureWidthReset = $(".feature__inner").innerHeight() - (featureItemWidth * 2);
    $(".feature__inner ").css("top", 0);
    let leftpercent = $(window).width() > 1024 ? 90 : 100;

    generateDots()
    generateIndex();


    $('.feature__left a').click(function (e) {
        let navId = $(this).index();
        let dotId = $(this).index() + 1;
        e.preventDefault()
        $(".feature__left a").removeClass("active").eq($(this).index()).addClass("active");
        setDot(dotId);
        navMenuSlide(navId);
    });
    $('.feature__dots span').click(function (e) {
        let navId = $(this).index();
        let dotId = $(this).index() + 1;
        e.preventDefault();

        $(".feature__dots span").removeClass("active").eq($(this).index()).addClass("active");

        navMenuSlide(navId);
        setLeftMenu(dotId);

    });
    $('.nav-left').on("click", function () {
        if (clicked) {
            prevSlide();
            clicked = false;
            stopClickedAnyway();
        }
    })
    $('.nav-right').on("click", function () {
        if (clicked) {
            nextSlide();
            clicked = false;
            stopClickedAnyway();
        }
    })

    function nextSlide() {
        if (slideNow != slideCount) {
            if (slideNow == slideCount || slideNow <= 0 || slideNow > slideCount) {
                $(".feature__slide").removeClass("active")
                slideNow = 1;
                setDot(slideNow);
                setLeftMenu(slideNow);
                $(".feature__inner").css({top: 0 + 'px'}, 0);
                $(".feature__slide:nth-child(" + slideNow + ")").addClass("active");
            } else {

                slideWidth = -$('.feature__slide').innerWidth() * slideNow;
                $(".feature__slide").removeClass("active");
                $('.feature__slides>div:nth-child(' + slideNow + ')').addClass('scale');
                $('.feature__slides>div:nth-child(' + (slideNow + 1) + ')').animate({
                    'left': '0'
                }, 1000);
                slideNow++;
                setDot(slideNow);
                setLeftMenu(slideNow);
                if (slideNow >= 4) {
                    $(".feature__inner").css({top: (-featureItemWidth * slideNow) + featureItemWidth * 4 + 'px'}, 0)
                }

                if (slideNow === slideCount) {
                    console.log(1);
                    $(".nav-right").addClass("no-active")
                }
                $(".feature__slide:nth-child(" + slideNow + ")").addClass("active");
            }
        }
    }


    function prevSlide() {
        if (slideNow != 1) {
            if (slideNow == 1 || slideNow <= 0 || slideNow > slideCount) {
                $(".feature__slide").removeClass("active")
                slideWidth = -$('.feature__slide').innerWidth() * (slideCount - 1);
                slideNow = slideCount;
                $(".feature__slide:nth-child(" + slideNow + ")").addClass("active");
                if (slideNow = slideCount) {
                    $(".feature__inner").css({top: -featureWidthReset + 'px'}, 0);
                }
                setDot(slideNow);
                setLeftMenu(slideNow);
                $(".nav-right").removeClass("no-active")

            } else {
                $(".feature__slide").removeClass("active")
                slideWidth = -$('.feature__slide').width() * (slideNow - 2);
                $(".feature__slide").removeClass("active");
                slideNow--;
                let zindex = $('.feature__slides>div:nth-child(' + (slideNow + 1) + ')').css('z-index');
                $('.feature__slides>div:nth-child(' + (slideNow + 1) + ')').animate({
                    'z-index': 99
                }, 1)
                setTimeout(() => {
                    $('.feature__slides>div:nth-child(' + (slideNow + 1) + ')').animate({
                        'left': leftpercent + '%'
                    }, 1000, function (event) {
                        $(this).css('z-index', zindex);
                    })
                }, 10)

                setTimeout(() => {
                    $('.feature__slides>div:nth-child(' + slideNow + ')').removeClass('scale');
                }, 500)
                $(".feature__slide:nth-child(" + slideNow + ")").addClass("active");
                setDot(slideNow);
                setLeftMenu(slideNow);
                $(".nav-right").removeClass("no-active")

                if (slideNow <= 3) {
                    $(".feature__inner").css({top: 0 + 'px'}, 0)

                } else {
                    $(".feature__inner").css({top: "+=" + featureItemWidth + 'px'}, 0)
                }

            }
        }
    }


    // set DOts and set Menu and Text
    function setDot(id) {
        $(".nav-right").removeClass("no-active")
        $(".nav-left").removeClass("no-active")

        $(".feature__dots span").removeClass("active");
        $(".feature__dots span:nth-child(" + id + ")").addClass("active");
        // changeText(id);
        if (id === slideCount) {
            $(".nav-right").addClass("no-active")
        }
        if (id === 1) {
            $(".nav-left").addClass("no-active")
        }
    }

    function changeText(id) {
        $(".feature__text>div").removeClass("active");
        $(".feature__text>div:nth-child(" + id + ")").addClass("active");
    }


    function setLeftMenu(id) {
        $(".nav-right").removeClass("no-active")
        $(".nav-left").removeClass("no-active")
        $(".feature__left a").removeClass("active");
        $(".feature__left a:nth-child(" + id + ")").addClass("active");
        changeText(id);
        if (id === 1) {
            $(".nav-left").addClass("no-active")
        }
        if (id === slideCount) {
            $(".nav-right").addClass("no-active")
        }
    }


    // dots and menu Click
    function navMenuSlide(navId) {
        if (navId + 1 != slideNow) {
            $(".feature__slide").removeClass("active")
            if (slideNow < navId + 1) {
                changeText(navId + 1);
                for (var i = slideNow; i < navId + 1; i++) {
                    $(".feature__slide").removeClass("active")
                    $('.feature__slides>div:nth-child(' + i + ')').addClass('scale');
                    $('.feature__slides>div:nth-child(' + (i + 1) + ')').animate({
                        'left': '0'
                    }, 500);
                    $('.feature__slides>div:nth-child(' + (i + 1) + ')').addClass('active');
                }
            } else {
                setTimeout(() => {
                    changeText(navId + 1);
                }, 500)

                for (var i = slideNow; i > navId; i--) {
                    $(".feature__slide").removeClass("active")
                    $('.feature__slides>div:nth-child(' + (i + 1) + ')').removeClass('scale');
                    $('.feature__slides>div:nth-child(' + i + ')').animate({
                        'left': '0'
                    }, 500);
                    $('.feature__slides>div:nth-child(' + (i + 1) + ')').animate({
                        'left': leftpercent + '%'
                    }, 500);
                    $('.feature__slides>div:nth-child(' + i + ')').addClass('active');
                }
            }
            slideNow = navId + 1;
            if (slideNow <= 3) {
                $(".feature__inner").css({top: 0 + 'px'}, 0)
            } else {
                $(".feature__inner").css({top: (-featureItemWidth * navId) + featureItemWidth * 3 + 'px'}, 0)
            }

        }
    }


    function generateIndex() {
        let indexLength = $('.feature__slide').length;
        $('.feature__slide').each(function (index) {
            $(this).css('z-index', indexLength);
            indexLength--;

        })
    }

    // gen dots
    function generateDots() {

        let arrayDots = []
        for (let i = 0; i < slideCount; i++) {
            let dots = document.createElement("span");
            arrayDots.push(dots);
        }
        $(".feature__dots").append(arrayDots);
        $(".feature__dots span").first().addClass("active");

    }

    // stop click
    function stopClickedAnyway() {
        setTimeout(function () {
            clicked = true;
        }, 800)
    }

    // touchswipe

    if ($(window).width() < 1024) {
        $('.feature__slides ').swipe({
            swipeStatus: (event, phase, direction, distance, duration, fingerCount, fingerData, currentDirection) => {
                if (phase == 'end') {
                    if (direction === 'up' || direction === 'down') return false;
                    if (direction == 'left') nextSlide();
                    if (direction == 'right') prevSlide();
                }
            },
            triggerOnTouchEnd: false,
            allowPageScroll: 'vertical',
            threshold: 60
        });

    }


});


$(document).ready(function () {

    //
    if ($(window).innerWidth() > 1200) {
        let slides = $(".integrations__row ");
        let minSlideLength = 7;
        slides.each(function (index, item) {
            if ($(this).find(".integrations__item").length < minSlideLength) {
                $(this).find(".integrations__arrow-left ").css("display", "none")
                $(this).find(".integrations__arrow-right").css("display", "none")
            }
        })
    }

    $(".integrations__row").on("click", function () {
        $('.integrations__row').eq($(this).index()).addClass('active').siblings().removeClass('active');
        if ($(window).width() < 601) {
            $(this).toggleClass('active');

            if ($(this).find(".integrations__slider").hasClass('hidden')) {
                $(".integrations__row .integrations__slider").addClass("hidden")
                $(this).find(".integrations__slider").removeClass("hidden")
            } else {
                $(this).find(".integrations__slider").addClass("hidden");
            }
        }
    })

    if ($(window).width() < 601) {
        $(".integrations__row").not($(this)).find(".integrations__slider").addClass("hidden")
    }

    $(".integrations__row:nth-child(1)").click();

    let intervalSlide;
    let directionSlide = 'left';

    if ($(window).innerWidth() > 1200) {


        function autoplaySlide(direction) {
            clearTimeout(intervalSlide);
            if (direction == "left") {
                let element = $('.integrations__row.active .integrations__item:nth-child(1)');
                let width = parseInt(element.css('marginRight').split('px')[0]) + parseInt(element.css('width').split('px')[0]);
                let parents = $('.integrations__row.active .integrations__slider');
                if (parents.find('.integrations__item').length < 7) {
                    intervalSlide = setTimeout(() => {
                        if (directionSlide == 'left') {
                            autoplaySlide('left');
                        } else {
                            autoplaySlide('right');
                        }
                    }, 0)
                } else {
                    $(element).animate({'margin-left': '-' + width + 'px'}, 1500, 'linear', function () {
                        $(this).appendTo(parents).css('margin-left', '0');
                        intervalSlide = setTimeout(() => {
                            if (directionSlide == 'left') {
                                autoplaySlide('left');
                            } else {
                                autoplaySlide('right');
                            }
                        }, 0)
                    });
                }
            } else {
                let element = $('.integrations__row.active .integrations__item:last-child');
                let width = parseInt(element.css('marginRight').split('px')[0]) + parseInt(element.css('width').split('px')[0]);
                let parents = $('.integrations__row.active .integrations__slider');
                if (parents.find('.integrations__item').length < 5) {
                    intervalSlide = setTimeout(() => {
                        if (directionSlide == 'left') {
                            autoplaySlide('left');
                        } else {
                            autoplaySlide('right');
                        }
                    }, 0)
                } else {
                    $(element).css('margin-left', '-' + width + 'px').prependTo(parents).animate(
                        {'margin-left': '0'}, 1500, 'linear', function () {
                            intervalSlide = setTimeout(() => {
                                if (directionSlide == 'left') {
                                    autoplaySlide('left');
                                } else {
                                    autoplaySlide('right');
                                }
                            }, 0)
                        });
                }
            }

        }

        autoplaySlide('left');


        $('.integrations__row').on('click', '.integrations__arrow-left', function (event) {
            event.preventDefault();
            if (directionSlide != 'left') {
                directionSlide = 'left';
            }
        })


        $('.integrations__row').on('click', '.integrations__arrow-right', function (event) {
            event.preventDefault();
            if (directionSlide != 'right') {
                directionSlide = 'right';
            }
        })
    } else {

        let clickLeft = false;
        $('.integrations__slider').swipe({
            swipeStatus: function (event, phase, direction, distance, duration, fingerCount, fingerData, currentDirection) {
                if (phase == "end") {
                    //сработает через 20 пикселей то число которое выбрали в threshold
                    if (direction == 'right') {
                        if (!clickLeft) {
                            let parents = $('.integrations__slider:not(.hidden)');
                            if (parents.find('.integrations__item').length > 2) {
                                clickLeft = true;
                                let element = $('.integrations__slider:not(.hidden) .integrations__item:last-child');
                                let width = parseInt(element.css('marginRight').split('px')[0]) + parseInt(element.css('width').split('px')[0]);
                                $(element).css('margin-left', '-' + width + 'px').prependTo(parents).animate(
                                    {'margin-left': '0'}, 500, 'linear', function () {
                                        clickLeft = false;
                                    });
                            }
                        }
                    }
                    if (direction == 'left') {
                        if (!clickLeft) {
                            let parents = $('.integrations__slider:not(.hidden)');
                            if (parents.find('.integrations__item').length > 2) {
                                clickLeft = true;
                                let element = $('.integrations__slider:not(.hidden) .integrations__item:nth-child(1)');
                                let width = parseInt(element.css('marginRight').split('px')[0]) + parseInt(element.css('width').split('px')[0]);
                                $(element).animate({'margin-left': '-' + width + 'px'}, 500, 'linear', function () {
                                    $(this).appendTo(parents).css('margin-left', '0');
                                    clickLeft = false;
                                });
                            }
                        }
                    }
                }
            },
            triggerOnTouchEnd: false,
            threshold: 20 // сработает через 20 пикселей
        });
    }

})

$(document).ready(function () {

    function isEmail(email) {
        var regex = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return regex.test(email);
    }

    function isPhone(phone) {
        var regex = /^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g;
        return regex.test(phone);
    }

    function validateEmail(e) {
        e.preventDefault()
        let errorValue = 0
        let mailInput = $(".intro__info .form input")
        let arrayError = new Array("Enter valid e-mail")

        if (!isEmail(mailInput.val())) {
            mailInput.addClass("error");
            // mailInput.next().text(arrayError[0]);
            errorValue++;
        } else {
            mailInput.removeClass("error")
            // mailInput.next().text('');
        }
        if (errorValue == 0) {
            $.ajax({
                url: '/wp-content/themes/opticore/mail.php',
                type: 'POST',
                contentType: false,
                processData: false,
                data: {
                    email: mailInput.val()
                },
                success: function (response) {
                    $('.popup-thank').addClass('open');
                    setTimeout(() => {
                        $('.popup-thank').removeClass('open');
                    }, 5000)
                }
            });
        }
        $(mailInput).on("input change", validateEmailChange)
    }

    function validateEmailChange() {
        let errorValue = 0
        let mailInput = $(".intro__info .form input")
        let arrayError = new Array("Enter valid e-mail")

        if (!isEmail(mailInput.val())) {
            mailInput.addClass("error");
            // mailInput.next().text(arrayError[0]);
            errorValue++;
        } else {
            mailInput.removeClass("error")
            // mailInput.next().text('');
        }
    }

    function validateEmailPopup(e) {
        e.preventDefault()
        let errorValue = 0
        let mailInput = $(".popup-contact .popup__body>input")
        let arrayError = new Array("Enter valid e-mail")

        if (!isEmail(mailInput.val())) {
            mailInput.addClass("error");
            errorValue++;
        } else {
            mailInput.removeClass("error")
        }
        if (errorValue == 0) {
            $.ajax({
                url: '/wp-content/themes/opticore/mail.php',
                type: 'POST',
                contentType: false,
                processData: false,
                data: {
                    email: mailInput.val()
                },
                success: function (response) {
                    $(".popup-contact").removeClass('active');
                    $('.popup-thank').addClass('open');
                    setTimeout(() => {
                        $('.popup-thank').removeClass('open');
                    }, 5000)
                }
            });
        }

        $(mailInput).on("input change", validateEmailPopupChange)
    }

    function validateEmailPopupPhone(e) {
        e.preventDefault()
        let errorValue = 0
        let mailInput = $(".popup-contactNew .popup__body>input.mail")
        let phoneInput = $(".popup-contactNew .popup__body>input.phone")
        let nameInput = $(".popup-contactNew .popup__body>input.name")
        let arrayError = new Array("Enter valid e-mail")

        if (!isEmail(mailInput.val())) {
            mailInput.addClass("error");
            errorValue++;
        } else {
            mailInput.removeClass("error")
        }

        if (!isPhone(phoneInput.val())) {
            phoneInput.addClass("error");
            errorValue++;
        } else {
            phoneInput.removeClass("error")
        }

        if (nameInput.val().length <= 3) {
            nameInput.addClass("error");
            errorValue++;
        } else {
            nameInput.removeClass("error")
        }

        if (errorValue == 0) {
            $.ajax({
                url: '/wp-content/themes/opticore/mailContact.php',
                type: 'POST',
                contentType: false,
                processData: false,
                data: {
                    email: mailInput.val(),
                    phone: phoneInput.val(),
                    name: nameInput.val(),
                },
                success: function (response) {
                    $(".popup-contactNew").removeClass('active');
                    $('.popup-thank').addClass('open');
                    setTimeout(() => {
                        $('.popup-thank').removeClass('open');
                    }, 5000)
                }
            });
        }

        $(mailInput).on("input change", validateEmailPopupChangePhone)
    }

    function validateEmailPopupChangePhone() {
        let errorValue = 0
        let mailInput = $(".popup-contactNew .popup__body>input.mail")
        if (!isEmail(mailInput.val())) {
            mailInput.addClass("error");
            errorValue++;
        } else {
            mailInput.removeClass("error");
        }
    }

    function validateEmailPopupChange() {
        let errorValue = 0
        let mailInput = $(".intro__info .form input")
        let arrayError = new Array("Enter valid e-mail")

        if (!isEmail(mailInput.val())) {
            mailInput.addClass("error");
            // mailInput.next().text(arrayError[0]);
            errorValue++;
        } else {
            mailInput.removeClass("error")
            // mailInput.next().text('');
        }
    }

    $(".intro__info .form button").on("click", validateEmail)
    $(".popup-contact .popup__body .btn").on("click", validateEmailPopup)
    $(".popup-contactNew .popup__body .btn").on("click", validateEmailPopupPhone)

    $('.customizable__tabs div:nth-child(2)').click();

    setTimeout(() => {
        $('.customizable__tabs div:nth-child(1)').click();
    }, 100)
})
